<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script>
		window.onload = function() {

			// Get references to elements on the page.
			var form = document.getElementById('message-form');
			var messageField = document.getElementById('message');
			var messagesList = document.getElementById('messages');
			var socketStatus = document.getElementById('status');
			var closeBtn = document.getElementById('close');
			var updateStatus = document.getElementById('update');
			var upResult = document.getElementById('up');
			var downResult = document.getElementById('down');
			var leftResult = document.getElementById('left');
			var rightpResult = document.getElementById('right');
			var forwardResult = document.getElementById('forward');
			var backwardResult = document.getElementById('backward');


			// Create a new WebSocket.
			var socket = new WebSocket('ws://websocket-nodejs.herokuapp.com');


			// Handle any errors that occur.
			socket.onerror = function(error) {
				console.log('WebSocket Error: ' + error);
			};


			// Show a connected message when the WebSocket is opened.
			socket.onopen = function(event) {
				socketStatus.innerHTML = 'Connected to server.';
				socketStatus.className = 'open';
			};


			// Handle messages sent by the server.
			socket.onmessage = function(event) {
				var data = JSON.parse(event.data);

				messagesList.innerHTML += '<li class="received"><span>Received:</span>' + data.message + '</li>';
			
				upResult.innerHTML = data.up;
				downResult.innerHTML = data.down;
				upResult.innerHTML = data.left;
				upResult.innerHTML = data.right;
				upResult.innerHTML = data.forward;
				upResult.innerHTML = data.backward;
			};


			// Show a disconnected message when the WebSocket is closed.
			socket.onclose = function(event) {
				socketStatus.innerHTML = 'Disconnected from server.';
				socketStatus.className = 'closed';
			};


			// Send a message when the form is submitted.
			form.onsubmit = function(e) {
				e.preventDefault();

				// Retrieve the message from the textarea.
				var message = messageField.value;
				message = message.toLowerCase();

				var received = true;

				switch(message)
				{
				case "up":
					break;
				case "down":
					break;
				case "left":
					break;
				case "right":
					break;
				case "forward":
					break;
				case "backward":
					break;
				default:
					received = false;
					break;
				}

				if(received)
				{
					updateStatus.innerHTML = "Vote successful!";
					updateStatus.className = 'open';
					setTimeout(function() {
					    updateStatus.innerHTML = '&nbsp';
					}, 2000); 
					// Send the message through the WebSocket.
					socket.send(message);
				} else {
					updateStatus.innerHTML = "Vote invalid: " + message + " is an invalid choice.";
					updateStatus.className = 'closed';
				}
				
				// Clear out the message field.
				messageField.value = '';

				return false;
			};


			// Close the WebSocket connection when the close button is clicked.
			closeBtn.onclick = function(e) {
				e.preventDefault();

				// Close the WebSocket.
				socket.close();

				return false;
			};
		};
	</script>
</head>

<div id="page-wrapper">
	<h1>Hack Western 2 plays Snake 3D</h1>

	<div id="status">Connecting...</div>

	<div id="update">Waiting for input...</div>

	<form id="message-form" action="#" method="post">
		<input type="text" id="message" placeholder="Write your command here..." required>
		<button type="submit">Vote</button>
		<button type="button" id="close">Close Connection</button>
	</form>
</div>
<div id="page-wrapper">
	<table cellspacing='0'> 
	<thead>
		<tr>
			<th>up</th>
			<th>down</th>
			<th>left</th>
			<th>right</th>
			<th>forward</th>
			<th>backward</th>
		</tr>
	</thead>

	<tbody>
		<tr>
			<td id='up'></td>
			<td id='down'></td> 
			<td id='left'></td>
			<td id='right'></td>
			<td id='forward'></td> 
			<td id='backward'></td>
		</tr>

	</tbody>
	</table>
	<ul id="messages"></ul>
</div>

<!-- <html>
	<head>
		<script src="script/jquery-1.11.3.min.js"></script>
		<style>
			body {
				font-family: "Helvetica Neue", helvetica, arial;
				padding: 15px;
			}

			ul {
				list-style: none;
				margin: 0;
				padding: 0;
			}

			ul li {
				line-height: 1.4;
			}
		</style>

		<script>
			var host = location.origin.replace(/^http/, 'ws')
			var ws = new WebSocket(host);
			ws.onmessage = function (event) {
				var data = JSON.parse(event.data);
				$("#up").text(data.up);
				$("#down").text(data.down);
				$("#left").text(data.left);
				$("#right").text(data.right);
				$("#forward").text(data.forward);
				$("#backward").text(data.backward);
			};
		</script>
	</head>
	<body>
		<h1>Snake</h1>
		<h2>Vote</h2>   
		<form action="index.js">
			Command: <input type="text" name="vote">
			<input type="submit" value="Submit">
		</form>
		<h2>Results</h2>
		<table border="1">
			<tr>
				<th>up</th>
				<th>down</th> 
				<th>left</th>
				<th>right</th> 
				<th>forward</th>
				<th>backward</th> 
			</tr>
			<tr>
				<td id='up'></td>
				<td id='down'></td> 
				<td id='left'></td>
				<td id='right'></td>
				<td id='forward'></td> 
				<td id='backward'></td>
			</tr>
		</table>
	</body>
</html> -->
